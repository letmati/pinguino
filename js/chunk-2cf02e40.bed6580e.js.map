{"version":3,"sources":["webpack:///./src/components/Pedidos.vue","webpack:///./src/components/Pedidos.vue?5964","webpack:///./src/components/Pedidos.vue?a614"],"names":["class","id","role","aria-label","for","pedido","stat","submitted","nuevoPedido","item","index","key","nombre","quitar","restar","type","cantidad","agregar","precioT","name","client","value","clientes","cliente","guardarPedido","onSubmit","store","getters","getPedido","clienteActual","getCliente","clientid","clientnombre","ide","form","fecha","Date","getTime","getTimezoneOffset","toISOString","split","async","x","incrementarStock","firestore","FieldValue","increment","incrementarCliente","saldo","commit","computed","this","methods","$router","push","render","__scopeId"],"mappings":"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","file":"js/chunk-2cf02e40.bed6580e.js","sourcesContent":["<template>\r\n  <h1 class=\"my-4\">Pedido actual</h1>\r\n\r\n  <div v-if=\"pedido == 0\">\r\n    <h2 class=\"my-5\">No hay productos en el pedido</h2>\r\n  </div>\r\n\r\n  <div v-else>\r\n    <div class=\"caja d-flex flex-column justify-content-between\" v-if=\"!stat.submitted\">\r\n      <div class=\"col-md-12\">\r\n        <div\r\n          class=\"list-group-item list-group-item-action list-group-item-light d-flex justify-content-between flex-column flex-wrap\"\r\n          v-for=\"(item, index) in pedido\"\r\n          :key=\"index\"\r\n        >\r\n          <div class=\"d-flex justify-content-end\">\r\n            <h5 class=\"w-100\">{{ item.nombre }}</h5>\r\n            <button @click=\"quitar(index)\" class=\"x\">X</button>\r\n          </div>\r\n\r\n          <div id=\"pedido\" class=\"d-flex\">\r\n            <div\r\n              class=\"btn-toolbar d-flex justify-content-evenly align-items-start w-50 h-0\"\r\n              role=\"toolbar\"\r\n            >\r\n              <div class=\"btn-group\" role=\"group\" aria-label=\"First group\">\r\n                <button @click=\"restar(index)\" type=\"button\" class=\"btn btn-danger\">-</button>\r\n              </div>\r\n\r\n              <div class=\"mx-3\">\r\n                <h5>{{ item.cantidad }}</h5>\r\n              </div>\r\n\r\n              <div class=\"btn-group\" role=\"group\" aria-label=\"Second group\">\r\n                <button @click=\"agregar(index)\" type=\"button\" class=\"btn btn-success\">+</button>\r\n              </div>\r\n            </div>\r\n\r\n            <h5 class=\"w-50\">$ {{ item.precioT }}</h5>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"botonera\">\r\n        <form>\r\n          <label for=\"clientes\">Cliente:</label>\r\n          <select name=\"clientes\" id=\"clientes\" v-model=\"client.value\">\r\n            <option v-for=\"(cliente, index) in clientes\" :key=\"index\">{{ cliente.nombre }}</option>\r\n          </select>\r\n        </form>\r\n\r\n        <div class=\"d-flex\">\r\n          <button @click=\"guardarPedido\" class=\"btn btn-warning my-4 w-100\">Guardar pedido</button>\r\n          <button @click=\"onSubmit\" class=\"btn btn-success my-4 w-100\">Confirmar pedido</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-else class=\"d-flex my-5 justify-content-center\">\r\n      <div class=\"d-flex flex-column my-5\">\r\n        <h1>Â¡Pedido confirmado!</h1>\r\n        <button @click=\"nuevoPedido\" class=\"btn btn-success my-5\">Nuevo pedido</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useStore } from \"vuex\";\r\nimport {\r\n  createPedido,\r\n  useLoadClientes,\r\n  updateItem,\r\n  updateCliente,\r\n} from \"@/firebase\";\r\nimport firebase from \"firebase/compat/app\";\r\nimport { reactive } from \"vue\";\r\n\r\nexport default {\r\n  setup() {\r\n    //Store\r\n    const store = useStore();\r\n    const pedido = store.getters.getPedido;\r\n    const clienteActual = store.getters.getCliente;\r\n\r\n    //Variables Clientes\r\n    var client = reactive({});\r\n\r\n    if (clienteActual) {\r\n      client.value = clienteActual;\r\n    }\r\n\r\n    let clientid = \"\";\r\n    let clientnombre = \"\";\r\n    const clientes = useLoadClientes();\r\n    const ide = reactive({ id: \"\" });\r\n\r\n\r\n    //StatusPedido\r\n    const stat = reactive({ submitted: false });\r\n\r\n    //Form Cliente y Fecha para DB\r\n    const form = reactive({ cliente: \"\", fecha: \"\" });\r\n    form.fecha = new Date();\r\n    form.fecha = new Date(\r\n      form.fecha.getTime() - form.fecha.getTimezoneOffset() * 60000\r\n    )\r\n      .toISOString()\r\n      .split(\"T\")[0];\r\n\r\n    //Funcion Submit pedido a DB\r\n    const onSubmit = async () => {\r\n      clientnombre = client.value;\r\n      clientnombre = clientnombre.split(/\\s(.+)/)[0];\r\n      form.cliente = clientnombre;\r\n      await createPedido({ ...pedido, ...form });\r\n      clientid = client.value;\r\n      clientid = clientid.split(/\\s(.+)/)[1];\r\n      for (let x in pedido) {\r\n        let incrementarStock = firebase.firestore.FieldValue.increment(\r\n          -pedido[x].cantidad\r\n        );\r\n        await updateItem(pedido[x].id, { cantidad: incrementarStock });\r\n      }\r\n      for (let x in pedido) {\r\n        let incrementarCliente = firebase.firestore.FieldValue.increment(\r\n          pedido[x].precioT\r\n        );\r\n        await updateCliente(clientid, { saldo: incrementarCliente });\r\n      }\r\n\r\n      if (clienteActual) {\r\n        store.commit(\"limpiarCliente\");\r\n      }\r\n\r\n      //Variable estado\r\n      stat.submitted = true;\r\n    };\r\n\r\n\r\n\r\n    return { store, pedido, onSubmit, stat, form, clientes, ide, client };\r\n  },\r\n  computed: {\r\n    getPedido() {\r\n      return this.store.getters.getPedido;\r\n    },\r\n    precioTotal() {\r\n      return this.pedido;\r\n    },\r\n  },\r\n  methods: {\r\n    nuevoPedido() {\r\n      this.stat.submitted = false;\r\n      this.store.commit(\"limpiarPedido\");\r\n      this.$router.push(\"/\");\r\n    },\r\n    guardarPedido() {\r\n      this.clientnombre = this.client.value;\r\n      this.clientnombre = this.clientnombre.split(/\\s(.+)/)[0];\r\n      this.form.cliente = this.clientnombre;\r\n      this.store.commit(\"guardarPedido\", ({ ...this.pedido, ...this.form }));\r\n      this.store.commit(\"limpiarPedido\");\r\n      this.stat.submitted = true;\r\n    },\r\n    agregar(index) {\r\n      this.store.commit(\"agregar\", index);\r\n    },\r\n    restar(index) {\r\n      this.store.commit(\"restar\", index);\r\n    },\r\n    quitar(index) {\r\n      this.store.commit(\"quitar\", index);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.caja {\r\n  height: 80vh;\r\n}\r\n.btn-success {\r\n  background: #4dba87;\r\n}\r\n\r\n.btn-warning {\r\n  color: white;\r\n}\r\n\r\n#pedido {\r\n  height: 5vh;\r\n}\r\n\r\n.x {\r\n  border-style: none;\r\n  border-radius: 1vw;\r\n  color: white;\r\n  background: red;\r\n}\r\n</style>\r\n","import { render } from \"./Pedidos.vue?vue&type=template&id=46dc558e&scoped=true\"\nimport script from \"./Pedidos.vue?vue&type=script&lang=js\"\nexport * from \"./Pedidos.vue?vue&type=script&lang=js\"\n\nimport \"./Pedidos.vue?vue&type=style&index=0&id=46dc558e&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-46dc558e\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Pedidos.vue?vue&type=style&index=0&id=46dc558e&scoped=true&lang=css\""],"sourceRoot":""}